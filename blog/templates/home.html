{% extends 'base.html' %}
{% load blog_extras %}
{% block content %}
    <section>
        {% if user.is_authenticated %}
                <em>Hello {{request.user}}!</em>
                <a href="{% url 'logout_user' %}">Se déconnecter</a>
        {% endif %}
    </section>
    <nav>
        <a href="{% url 'reviews-create_ticket' %}">Demander une critique</a>
        <a href="{% url 'reviews-create_review' %}">Créer une critique</a>
        <a href="{% url 'reviews-follow_user' %}">Suivre des utilisateurs</a>
    </nav>
    <section>
        <div class="tickets_and_reviews">
        {% for instance in tickets_and_reviews %}
            {% if instance|model_type == 'Ticket' %}
                <sub>{{instance.user}} a demandé une critique - {{instance.time_created}}</sub>
                <h3>{{instance.title}}</h3>
                <p>{{instance.description}}</p>
                {% if instance.image %}
                    <img src="{{instance.image.url}}">
                {% endif %}
                {% if instance.user == user %}
                    <p><a href="{% url 'reviews_edit' instance.id %}"><button type="submit"> Modifier</button></a></p>
                {% else %}
                    <p><a href="{% url 'reviews_reply_to_ticket' instance.id %}"><button type="submit"> répondre</button></a></p>
                {% endif %}
            {% endif %}
            {% if instance|model_type == 'Review' %}
                <sub>{{instance.user}} - {{instance.time_created}}</sub>
                <h3>{{instance.headline}}</h3>
                <p>{{instance.rating}}</p>
            {% endif %}
        {% endfor %}
        </div>
    </section>
{% endblock content %}